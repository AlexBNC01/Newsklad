# üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Timeweb Cloud

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ Timeweb Cloud
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [timeweb.cloud](https://timeweb.cloud)
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç
3. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –æ–±–ª–∞—á–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (VPS)
1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–±–µ—Ä–∏—Ç–µ **"–û–±–ª–∞—á–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã"**
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–µ—Ä"**
3. –í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
   - **–û–°**: Ubuntu 22.04 LTS
   - **CPU**: 2 vCPU (–º–∏–Ω–∏–º—É–º)
   - **RAM**: 2 GB (–º–∏–Ω–∏–º—É–º)
   - **SSD**: 20 GB (–º–∏–Ω–∏–º—É–º)
   - **–õ–æ–∫–∞—Ü–∏—è**: –ú–æ—Å–∫–≤–∞ (–∏–ª–∏ –±–ª–∏–∂–∞–π—à–∞—è –∫ –≤–∞–º)
4. –°–æ–∑–¥–∞–π—Ç–µ SSH –∫–ª—é—á –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–æ–ª—å
5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö PostgreSQL
1. –í –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–±–µ—Ä–∏—Ç–µ **"–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"**
2. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö"**
3. –í—ã–±–µ—Ä–∏—Ç–µ **PostgreSQL 15**
4. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ**: `skladreact`
   - **CPU**: 1 vCPU
   - **RAM**: 1 GB
   - **SSD**: 10 GB
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

### 4. –°–æ–∑–¥–∞–Ω–∏–µ S3-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
1. –í –ø–∞–Ω–µ–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ **"–û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ"**
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ**: `skladreact-files`
   - **–õ–æ–∫–∞—Ü–∏—è**: —Ç–∞ –∂–µ, —á—Ç–æ –∏ —Å–µ—Ä–≤–µ—Ä
3. –°–æ–∑–¥–∞–π—Ç–µ Access Key –∏ Secret Key
4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS –ø–æ–ª–∏—Ç–∏–∫–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh root@your-server-ip
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
apt update && apt upgrade -y
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 18+
```bash
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
apt-get install -y nodejs
node --version  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Ä—Å–∏—é
npm --version
```

### 4. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 (–º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)
```bash
npm install -g pm2
```

### 5. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx
```bash
apt install nginx -y
systemctl enable nginx
systemctl start nginx
```

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall
```bash
ufw allow 22      # SSH
ufw allow 80      # HTTP
ufw allow 443     # HTTPS
ufw enable
```

## üì¶ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
```bash
cd /var/www
git clone https://github.com/your-username/skladreact.git
cd skladreact/backend
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
npm install --production
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp .env.example .env
nano .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ `.env` —Ñ–∞–π–ª:
```bash
NODE_ENV=production
PORT=3000
APP_URL=https://your-domain.ru

# PostgreSQL (–∏–∑ –ø–∞–Ω–µ–ª–∏ Timeweb)
DB_HOST=your-postgres-host.timeweb.cloud
DB_PORT=5432
DB_NAME=skladreact
DB_USER=your-username
DB_PASSWORD=your-password
DB_SSL=true

# JWT —Å–µ–∫—Ä–µ—Ç—ã (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏)
JWT_SECRET=your-very-strong-jwt-secret
JWT_REFRESH_SECRET=your-very-strong-refresh-secret

# S3 Storage
S3_ENDPOINT=https://s3.timeweb.cloud
S3_ACCESS_KEY=your-access-key
S3_SECRET_KEY=your-secret-key
S3_BUCKET_NAME=skladreact-files
S3_REGION=ru-central1

# Email –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
SMTP_HOST=smtp.timeweb.ru
SMTP_PORT=587
SMTP_USER=noreply@your-domain.ru
SMTP_PASSWORD=your-smtp-password
```

### 4. –ú–∏–≥—Ä–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
npm run migrate
```

### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PM2
–°–æ–∑–¥–∞–π—Ç–µ `ecosystem.config.js`:
```bash
nano ecosystem.config.js
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:
```javascript
module.exports = {
  apps: [{
    name: 'skladreact-api',
    script: 'server.js',
    instances: 'max',
    exec_mode: 'cluster',
    env: {
      NODE_ENV: 'production',
      PORT: 3000
    },
    error_file: './logs/err.log',
    out_file: './logs/out.log',
    log_file: './logs/combined.log',
    time: true,
    max_memory_restart: '500M'
  }]
};
```

–°–æ–∑–¥–∞–π—Ç–µ –ø–∞–ø–∫—É –¥–ª—è –ª–æ–≥–æ–≤:
```bash
mkdir logs
```

### 6. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
nano /etc/nginx/sites-available/skladreact
```

–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:
```nginx
server {
    listen 80;
    server_name your-domain.ru www.your-domain.ru;
    
    # –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.ru www.your-domain.ru;
    
    # SSL –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞)
    ssl_certificate /etc/letsencrypt/live/your-domain.ru/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.ru/privkey.pem;
    
    # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
    add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline'" always;
    
    # Gzip —Å–∂–∞—Ç–∏–µ
    gzip on;
    gzip_types text/plain application/json application/javascript text/css application/xml text/xml;
    
    # –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ Node.js
    location /api {
        proxy_pass http://127.0.0.1:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
    
    # –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    location / {
        try_files $uri $uri/ =404;
    }
}
```

### 2. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```bash
ln -s /etc/nginx/sites-available/skladreact /etc/nginx/sites-enabled/
nginx -t  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
systemctl reload nginx
```

## üîí SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Let's Encrypt)

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Certbot
```bash
apt install certbot python3-certbot-nginx -y
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
```bash
certbot --nginx -d your-domain.ru -d www.your-domain.ru
```

### 3. –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞
```bash
crontab -e
```

–î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
```bash
0 12 * * * /usr/bin/certbot renew --quiet
```

## üì± –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–∏—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é API
–í —Ñ–∞–π–ª–µ `src/config/api.js`:
```javascript
const API_BASE_URL = 'https://your-domain.ru/api';
```

### 2. –°–æ–±–µ—Ä–∏—Ç–µ –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
cd ../  # –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
npx expo build:android  # –î–ª—è Android
npx expo build:ios      # –î–ª—è iOS
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ PM2
```bash
pm2 status
pm2 logs skladreact-api
pm2 monit
```

### 2. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Nginx
```bash
tail -f /var/log/nginx/error.log
tail -f /var/log/nginx/access.log
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–µ—Å—É—Ä—Å–æ–≤
```bash
htop
df -h  # –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
free -h  # –ü–∞–º—è—Ç—å
```

### 4. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç `backup.sh`:
```bash
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/var/backups/skladreact"
mkdir -p $BACKUP_DIR

# –ë—ç–∫–∞–ø PostgreSQL
PGPASSWORD="$DB_PASSWORD" pg_dump -h $DB_HOST -U $DB_USER -d $DB_NAME > $BACKUP_DIR/skladreact_$DATE.sql

# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
find $BACKUP_DIR -name "*.sql" -mtime +30 -delete
```

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:
```bash
chmod +x backup.sh
crontab -e
# –î–æ–±–∞–≤–∏—Ç—å: 0 2 * * * /var/www/skladreact/backup.sh
```

## üí∞ –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–¥–æ 10 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
- **VPS**: 2 vCPU, 2 GB RAM - ~790‚ÇΩ/–º–µ—Å
- **PostgreSQL**: 1 vCPU, 1 GB RAM - ~590‚ÇΩ/–º–µ—Å  
- **S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**: 10 GB - ~50‚ÇΩ/–º–µ—Å
- **–î–æ–º–µ–Ω .ru**: ~350‚ÇΩ/–≥–æ–¥
- **–ò—Ç–æ–≥–æ**: ~1430‚ÇΩ/–º–µ—Å + ~350‚ÇΩ/–≥–æ–¥

### –°—Ä–µ–¥–Ω—è—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–¥–æ 50 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):
- **VPS**: 4 vCPU, 4 GB RAM - ~1590‚ÇΩ/–º–µ—Å
- **PostgreSQL**: 2 vCPU, 2 GB RAM - ~1190‚ÇΩ/–º–µ—Å
- **S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ**: 50 GB - ~250‚ÇΩ/–º–µ—Å
- **–ò—Ç–æ–≥–æ**: ~3030‚ÇΩ/–º–µ—Å

## üÜò –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
pm2 logs skladreact-api  # –°–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
pm2 restart all          # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
psql -h $DB_HOST -U $DB_USER -d $DB_NAME
```

### –ü—Ä–æ–±–ª–µ–º–∞: –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞
```bash
pm2 scale skladreact-api +2  # –î–æ–±–∞–≤–ª—è–µ–º 2 –ø—Ä–æ—Ü–µ—Å—Å–∞
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```bash
cd /var/www/skladreact
git pull
cd backend
npm install
npm run migrate  # –ï—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
pm2 reload all
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Timeweb**: [help.timeweb.com](https://help.timeweb.com)
- **–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞**: support@timeweb.com
- **–¢–µ–ª–µ—Ñ–æ–Ω**: 8 (800) 700-06-08